"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[2580],{62580:(e,t,r)=>{r.r(t),r.d(t,{default:()=>u});var n=r(67294),l=r(63475),a=r(99381),s=r(11965);function u(e){const{height:t,width:r,echartOptions:u,setDataMask:c,labelMap:i,groupby:o,refs:h,selectedValues:d}=e,f=(0,n.useCallback)((e=>{const t=e.map((e=>i[e]));c({extraFormData:{filters:0===e.length?[]:o.map(((e,r)=>{const n=t.map((e=>e[r]));return null==n?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:n}}))},filterState:{value:t.length?t:null,selectedValues:e.length?e:null}})}),[c,o,i]),p={...(0,a.C0)(e),handleChange:f};return(0,s.tZ)(l.Z,{refs:h,height:t,width:r,echartOptions:u,eventHandlers:p,selectedValues:d})}},63475:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(67294),l=r(51995),a=r(31431),s=r(11965);const u=l.iK.div`
  height: ${e=>{let{height:t}=e;return t}};
  width: ${e=>{let{width:t}=e;return t}};
`;function c(e,t){let{width:r,height:l,echartOptions:c,eventHandlers:i,zrEventHandlers:o,selectedValues:h={},refs:d}=e;const f=(0,n.useRef)(null);d&&(d.divRef=f);const p=(0,n.useRef)(),g=(0,n.useMemo)((()=>Object.keys(h)||[]),[h]),m=(0,n.useRef)([]);(0,n.useImperativeHandle)(t,(()=>({getEchartInstance:()=>p.current}))),(0,n.useEffect)((()=>{f.current&&(p.current||(p.current=(0,a.S1)(f.current)),Object.entries(i||{}).forEach((e=>{var t,r;let[n,l]=e;null==(t=p.current)||t.off(n),null==(r=p.current)||r.on(n,l)})),Object.entries(o||{}).forEach((e=>{var t,r;let[n,l]=e;null==(t=p.current)||t.getZr().off(n),null==(r=p.current)||r.getZr().on(n,l)})),p.current.setOption(c,!0))}),[c,i,o]),(0,n.useEffect)((()=>{p.current&&(p.current.dispatchAction({type:"downplay",dataIndex:m.current.filter((e=>!g.includes(e)))}),g.length&&p.current.dispatchAction({type:"highlight",dataIndex:g}),m.current=g)}),[g]);const v=(0,n.useCallback)((e=>{let{width:t,height:r}=e;p.current&&p.current.resize({width:t,height:r})}),[]);return(0,n.useEffect)((()=>(v({width:r,height:l}),()=>{var e;return null==(e=p.current)?void 0:e.dispose()})),[]),(0,n.useLayoutEffect)((()=>{v({width:r,height:l})}),[r,l,v]),(0,s.tZ)(u,{ref:f,height:l,width:r})}const i=(0,n.forwardRef)(c)},99381:(e,t,r)=>{r.d(t,{C0:()=>o});var n=r(51115),l=r(67190),a=r(10581),s=r(6915);const u=(e,t,r)=>n=>{const l=Object.values(e);let a;a=l.includes(n)?l.filter((e=>e!==n)):[n];const s=a.map((e=>r[e]));return{dataMask:{extraFormData:{filters:0===a.length?[]:t.map(((e,t)=>{const r=s.map((e=>e[t]));return null==r?{col:e,op:"IS NULL"}:{col:e,op:"IN",val:r}}))},filterState:{value:s.length?s:null,selectedValues:a.length?a:null}},isCurrentValueSelected:l.includes(n)}},c=(e,t,r)=>n=>{var l;let{name:a}=n;if(!r)return;const s=null==(l=e(a))?void 0:l.dataMask;s&&t(s)},i=(e,t,r,u,c,i)=>o=>{if(t){o.event.stop();const h=o.event.event,d=[];if(e.length>0){const t=r[o.name];e.forEach(((e,r)=>{d.push({col:e,op:"==",val:t[r],formattedVal:(0,s.mj)(t[r],{timeFormatter:(0,n.bt)(c.dateFormat),numberFormatter:(0,l.JB)(c.numberFormat),coltype:null==i?void 0:i[(0,a.Z)(e)]})})}))}t(h.clientX,h.clientY,{drillToDetail:d,crossFilter:u(o.name),drillBy:{filters:d,groupbyFieldName:"groupby"}})}},o=e=>{const{groupby:t,onContextMenu:r,setDataMask:n,labelMap:l,emitCrossFilters:a,selectedValues:s,coltypeMapping:o,formData:h}=e;return{click:c(u(s,t,l),n,a),contextmenu:i(t,r,l,u(s,t,l),h,o)}}}}]);
//# sourceMappingURL=a40ca733b99229060536.chunk.js.map